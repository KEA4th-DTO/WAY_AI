import os
from PIL import Image, ImageDraw
import numpy as np
import random
from shapely.geometry import Polygon, Point

#강원도 폴리곤 좌표
Gangwon = Polygon([(212,54), (225, 69), (230, 65),
                          (231, 74), (245, 74), (247, 85),
                          (265, 96), (253, 103), (255, 128),
                          (281, 137), (272, 178), (281, 185),
                          (290, 182), (293, 170), (336, 188),
                          (366, 194), (421, 183), (329, 13), (314, 45)])

#서울 포함 경기도 폴리곤 좌표
Gyeonggi_Seoul = Polygon([(212, 54), (225, 69), (230, 65),
                                 (231, 74), (245, 74), (247, 85),
                                 (265, 96), (253, 103), (255, 128),
                                 (281, 137), (272, 178), (231, 212),
                                 (215, 204), (195, 208), (176, 185),
                                 (166, 156), (147, 149), (136, 107), (166, 112)])

#서울 폴리곤 좌표
Seoul = Polygon([(209, 121), (216, 133), (214, 134),
                        (219, 137), (210, 152), (208, 148),
                        (196, 150), (194, 143), (189, 146),
                        (186, 144), (186, 138), (183, 135),
                        (187, 129), (192, 133), (196, 132),
                        (196, 125), (199, 123), (200, 126), (204, 120)])

#서울 제외 경기도 폴리곤 좌표
Gyeonggi = Gyeonggi_Seoul.difference(Seoul)

#충남 폴리곤 좌표
Chungcheongnam = Polygon([(231, 212), (242, 226), (240, 229),
                                 (236, 229), (233, 239), (230, 241),
                                 (232, 248), (242, 254), (239, 258),
                                 (255, 269), (249, 286), (258, 288),
                                 (263, 306), (261, 314), (254, 310),
                                 (252, 316), (245, 316), (244, 310),
                                 (239, 313), (235, 299), (215, 306),
                                 (210, 304), (207, 296), (194, 297),
                                 (190, 310), (175, 313), (168, 299),
                                 (159, 296), (166, 292), (125, 231),
                                 (131, 213), (152, 193), (162, 194),
                                 (182, 202), (195, 208), (215, 204)])

#충북 폴리곤 좌표
Chungcheongbuk = Polygon([(293, 170), (336, 188), (366, 194),
                                 (348, 196), (336, 214), (335, 223),
                                 (318, 216), (315, 223), (308, 220),
                                 (304, 224), (301, 222), (300, 234),
                                 (291, 231), (287, 236), (289, 245),
                                 (284, 240), (277, 246), (287, 256),
                                 (283, 260), (285, 274), (282, 278),
                                 (282, 283), (287, 280), (293, 286),
                                 (298, 284), (300, 292), (296, 290),
                                 (294, 294), (293, 304), (284, 312),
                                 (263, 306), (258, 288), (249, 286),
                                 (255, 269), (239, 258), (242, 254),
                                 (232, 248), (230, 241), (233, 239),
                                 (236, 229), (240, 229), (242, 226),
                                 (231, 212), (272, 178), (281, 185), (290, 182)])

#경북 폴리곤 좌표
Gyeongsangbuk = Polygon([(421, 183), (427, 315), (437, 304),
                                (440, 310), (430, 348), (415, 353),
                                (405, 345), (395, 347), (388, 357),
                                (375, 355), (370, 361), (350, 361),
                                (344, 350), (330, 342), (326, 352),
                                (311, 353), (313, 340), (304, 332),
                                (294, 333), (285, 324), (284, 312),
                                (293, 304), (294, 294), (296, 290),
                                (300, 292), (298, 284), (293, 286),
                                (287, 280), (282, 283), (282, 278),
                                (285, 274), (283, 260), (287, 256),
                                (277, 246), (284, 240), (289, 245),
                                (287, 236), (291, 231), (300, 234),
                                (301, 222), (304, 224), (308, 220),
                                (315, 223), (318, 216), (335, 223),
                                (336, 214), (348, 196), (366, 194)])

#경남 폴리곤 좌표
Gyeongsangnam = Polygon([(430, 348), (415, 353), (405, 345),
                                (395, 347), (388, 357), (375, 355),
                                (370, 361), (350, 361), (344, 350),
                                (330, 342), (326, 352), (311, 353),
                                (313, 340), (304, 332), (294, 333),
                                (285, 324), (264, 340), (258, 353),
                                (259, 364), (264, 370), (264, 379),
                                (260, 390), (257, 391), (264, 409),
                                (277, 421), (274, 430), (283, 456),
                                (301, 459), (304, 434), (316, 448),
                                (351, 458), (359, 455), (363, 448),
                                (365, 417), (371, 425), (396, 419), (420, 385)])

#전북 폴리곤 좌표
Jeollabuk = Polygon([(257, 391), (260, 390), (264, 379),
                            (264, 370), (259, 364), (258, 353),
                            (264, 340), (285, 324), (284, 312),
                            (263, 306), (261, 314), (254, 310),
                            (252, 316), (245, 316), (244, 310),
                            (239, 313), (235, 299), (215, 306),
                            (210, 304), (207, 296), (194, 297),
                            (190, 310), (175, 313), (161, 318),
                            (170, 326), (188, 326), (178, 331),
                            (185, 337), (171, 337), (171, 342),
                            (156, 355), (156, 358), (160, 361),
                            (173, 359), (177, 363), (175, 365),
                            (171, 362), (168, 365), (158, 367),
                            (153, 378), (158, 378), (161, 391),
                            (167, 392), (168, 389), (174, 389),
                            (182, 379), (182, 373), (193, 374),
                            (199, 382), (203, 380), (204, 374),
                            (208, 375), (208, 382), (210, 385),
                            (210, 392), (224, 388), (229, 391),
                            (241, 391), (248, 385)])

#전남 폴리곤 좌표
Jeollanam = Polygon([(153, 378), (158, 378), (161, 391),
                            (167, 392), (168, 389), (174, 389),
                            (182, 379), (182, 373), (193, 374),
                            (199, 382), (203, 380), (204, 374),
                            (208, 375), (208, 382), (210, 385),
                            (210, 392), (224, 388), (229, 391),
                            (241, 391), (248, 385), (257, 391),
                            (264, 409), (277, 421), (274, 430),
                            (283, 456), (161, 523), (158, 496),
                            (126, 496), (143, 399)])


polygon_list = [Gangwon, Gyeonggi, Seoul, Chungcheongnam,
                Chungcheongbuk, Gyeongsangbuk, Gyeongsangnam, 
                Jeollabuk, Jeollanam]
filename_list = ["CNNTData/Gangwon", "CNNTData/Gyeonggi", "CNNTData/Seoul", "CNNTData/Chungcheongnam",
                "CNNTData/Chungcheongbuk", "CNNTData/Gyeongsangbuk", "CNNTData/Gyeongsangnam", 
                "CNNTData/Jeollabuk", "CNNTData/Jeollanam"]

# 지도 이미지 경로 설정
map_image_path = "CNNData/Map.jpg"  # 지도 이미지 파일 경로 설정
pin_image_path = "CNNData/Pin.jpg"  # 핀 이미지 파일 경로 설정

# 지도 이미지와 핀 이미지 불러오기
map_image = Image.open(map_image_path)
pin_image = Image.open(pin_image_path)

# 핀 이미지 크기 설정 (원하는 크기로 조정 가능)
pin_width = 15
pin_height = 15
pin_image_resized = pin_image.resize((pin_width, pin_height))

for polygon, fn in zip(polygon_list, filename_list):
    min_x, min_y, max_x, max_y = polygon.bounds

    draw = ImageDraw.Draw(map_image)
    for j in range(30):
        # for i in range(10):
        map_with_pin = map_image.copy()
        for i in range(100):
            # 경계 상자 내에 랜덤한 점 생성
            x = random.uniform(min_x, max_x)
            y = random.uniform(min_y, max_y)
            point = Point(x, y)
            
            # 생성된 점이 폴리곤 내부에 있는지 확인
            if polygon.contains(point):
                # 핀 이미지를 해당 위치에 그림
                map_with_pin.paste(pin_image_resized, (int(x - pin_width / 2), int(y - pin_height / 2)), pin_image_resized)
                
        filename = os.path.join(fn, f"{j}.jpg")        
        # 결과 이미지 저장
        map_with_pin.save(filename)